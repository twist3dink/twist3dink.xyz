<!DOCTYPE html>
<html lang="en">
<head>
    <script>if(window.location.pathname.endsWith(".html")){window.location.replace(window.location.pathname.slice(0,-5)+"/");}</script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lesson 3: RFID & NFC Hacking | tw¬°st3d_¬°nk Academy</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --bg-dark: #0a0a0a;
      --bg-card: #1a1a1a;
      --accent: #00ff88;
      --text-primary: #ffffff;
      --text-secondary: #b0b0b0;
      --border: #333;
      --warning: #ff9500;
    }

    body {
      font-family: 'Atkinson Hyperlegible', sans-serif;
      background: var(--bg-dark);
      color: var(--text-primary);
      line-height: 1.8;
      padding: 20px;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
    }

    /* Accessibility Controls */
    .a11y-controls {
      position: fixed;
      top: 20px;
      right: 20px;
      background: var(--bg-card);
      border: 2px solid var(--border);
      border-radius: 12px;
      padding: 15px;
      z-index: 1000;
      display: flex;
      gap: 10px;
    }

    .a11y-btn {
      background: var(--bg-dark);
      border: 1px solid var(--border);
      color: var(--text-primary);
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s ease;
    }

    .a11y-btn:hover {
      border-color: var(--accent);
      color: var(--accent);
    }

    .a11y-btn:focus {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }

    /* Navigation */
    .lesson-nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      flex-wrap: wrap;
      gap: 15px;
    }

    .nav-link {
      color: var(--text-secondary);
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: color 0.3s ease;
    }

    .nav-link:hover {
      color: var(--accent);
    }

    .lesson-badge {
      background: var(--bg-card);
      border: 2px solid var(--accent);
      padding: 8px 16px;
      border-radius: 8px;
      font-weight: 700;
      color: var(--accent);
    }

    /* Header */
    .lesson-header {
      margin-bottom: 40px;
    }

    .lesson-title {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 15px;
      background: linear-gradient(135deg, var(--accent), #00ccff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .lesson-meta {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      color: var(--text-secondary);
      font-size: 0.95rem;
    }

    .meta-item {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    /* Content Sections */
    .content-section {
      background: var(--bg-card);
      border: 2px solid var(--border);
      border-radius: 16px;
      padding: 30px;
      margin-bottom: 30px;
    }

    .section-title {
      font-size: 1.8rem;
      font-weight: 700;
      margin-bottom: 20px;
      color: var(--accent);
    }

    .section-subtitle {
      font-size: 1.3rem;
      font-weight: 700;
      margin-top: 25px;
      margin-bottom: 15px;
      color: var(--text-primary);
    }

    p {
      margin-bottom: 15px;
      color: var(--text-secondary);
    }

    /* Alert Boxes */
    .alert {
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 20px;
      border: 2px solid;
    }

    .alert-warning {
      background: rgba(255, 149, 0, 0.1);
      border-color: var(--warning);
      color: var(--warning);
    }

    .alert-info {
      background: rgba(0, 255, 136, 0.1);
      border-color: var(--accent);
      color: var(--accent);
    }

    .alert-title {
      font-weight: 700;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    /* Lists */
    ul, ol {
      margin-left: 25px;
      margin-bottom: 20px;
      color: var(--text-secondary);
    }

    li {
      margin-bottom: 10px;
      line-height: 1.7;
    }

    /* Progress Footer */
    .lesson-footer {
      background: var(--bg-card);
      border: 2px solid var(--border);
      border-radius: 16px;
      padding: 30px;
      margin-top: 40px;
    }

    .completion-section {
      text-align: center;
    }

    .xp-reward {
      font-size: 3rem;
      font-weight: 700;
      color: var(--accent);
      margin-bottom: 10px;
    }

    .complete-btn {
      background: var(--accent);
      color: var(--bg-dark);
      border: none;
      padding: 15px 40px;
      border-radius: 12px;
      font-weight: 700;
      font-size: 1.1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-top: 20px;
    }

    .complete-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 8px 24px rgba(0, 255, 136, 0.4);
    }

    .complete-btn:disabled {
      background: var(--border);
      color: var(--text-secondary);
      cursor: not-allowed;
      transform: none;
    }

    .nav-buttons {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-top: 20px;
      flex-wrap: wrap;
    }

    .nav-btn {
      background: var(--bg-dark);
      color: var(--accent);
      border: 2px solid var(--accent);
      padding: 12px 30px;
      border-radius: 8px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
    }

    .nav-btn:hover {
      background: var(--accent);
      color: var(--bg-dark);
    }

    /* Font Size Classes */
    body.font-small { font-size: 14px; }
    body.font-large { font-size: 18px; }
    body.font-xl { font-size: 22px; }

    /* High Contrast Mode */
    body.high-contrast {
      --bg-dark: #000000;
      --bg-card: #1a1a1a;
      --text-primary: #ffffff;
      --border: #00ff88;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .lesson-title {
        font-size: 2rem;
      }

      .a11y-controls {
        position: static;
        margin-bottom: 20px;
        flex-wrap: wrap;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Accessibility Controls -->
    <div class="a11y-controls">
      <button class="a11y-btn" onclick="changeFontSize('small')" aria-label="Decrease font size">A-</button>
      <button class="a11y-btn" onclick="changeFontSize('normal')" aria-label="Normal font size">A</button>
      <button class="a11y-btn" onclick="changeFontSize('large')" aria-label="Increase font size">A+</button>
      <button class="a11y-btn" onclick="changeFontSize('xl')" aria-label="Extra large font size">A++</button>
      <button class="a11y-btn" onclick="toggleContrast()" aria-label="Toggle high contrast">‚óê</button>
    </div>

    <!-- Navigation -->
    <nav class="lesson-nav">
      <a href="../../" class="nav-link">‚Üê Back to Course</a>
      <span class="lesson-badge">LESSON 3</span>
      <a href="../lesson-4/" class="nav-link">Next Lesson ‚Üí</a>
    </nav>

    <!-- Lesson Header -->
    <header class="lesson-header">
      <h1 class="lesson-title">RFID & NFC Hacking</h1>
      <div class="lesson-meta">
        <span class="meta-item">‚è±Ô∏è 50 minutes</span>
        <span class="meta-item">‚ö° 50 XP</span>
        <span class="meta-item">üì∂ Difficulty: Medium</span>
      </div>
    </header>

    <!-- Introduction -->
    <section class="content-section">
      <h2 class="section-title">üîê Introduction to RFID & NFC</h2>
      
      <p>Radio Frequency Identification (RFID) and Near Field Communication (NFC) are everywhere in modern life. From office access cards to hotel key cards, contactless payment systems to public transportation passes, these technologies power countless access control and identification systems.</p>

      <p>The Flipper Zero can read, save, emulate, and in some cases, clone both RFID (125 kHz) and NFC (13.56 MHz) cards and tags. This lesson will teach you how these systems work and how to interact with them safely and legally.</p>

      <div class="alert alert-warning">
        <div class="alert-title">‚ö†Ô∏è Legal Warning</div>
        <p>Cloning or emulating access cards without authorization is illegal. Only test with cards you own or have explicit permission to use. This lesson is for educational and security research purposes only.</p>
      </div>
    </section>

    <!-- Understanding RFID -->
    <section class="content-section">
      <h2 class="section-title">üì° Understanding RFID Technology</h2>

      <h3 class="section-subtitle">What is RFID?</h3>
      <p>RFID (Radio Frequency Identification) uses electromagnetic fields to automatically identify and track tags attached to objects. The Flipper Zero works with Low Frequency (LF) RFID at 125 kHz.</p>

      <h3 class="section-subtitle">Common 125 kHz RFID Applications</h3>
      <ul>
        <li><strong>Building Access Cards</strong> - Office buildings, apartments, parking garages</li>
        <li><strong>Hotel Key Cards</strong> - Many hotels use 125 kHz RFID</li>
        <li><strong>Pet Microchips</strong> - Identification chips implanted in animals</li>
        <li><strong>Vehicle Immobilizers</strong> - Car key authentication systems</li>
        <li><strong>Time & Attendance</strong> - Employee clock-in/out systems</li>
      </ul>

      <h3 class="section-subtitle">How RFID Works</h3>
      <ol>
        <li><strong>Card/Tag</strong> - Contains a coil antenna and microchip (no battery needed)</li>
        <li><strong>Reader</strong> - Emits electromagnetic field at 125 kHz</li>
        <li><strong>Power Transfer</strong> - Card enters field and harvests energy inductively</li>
        <li><strong>Data Transmission</strong> - Card modulates field to send its unique ID</li>
        <li><strong>Authentication</strong> - Reader verifies ID against database</li>
      </ol>

      <div class="alert alert-info">
        <div class="alert-title">üí° Key Insight</div>
        <p>Most 125 kHz RFID systems only transmit a simple ID number with no encryption. This makes them vulnerable to cloning if physical access to a valid card is obtained.</p>
      </div>
    </section>

    <!-- Reading RFID -->
    <section class="content-section">
      <h2 class="section-title">üìñ Reading RFID Cards</h2>

      <h3 class="section-subtitle">Step-by-Step: Reading a Card</h3>
      <ol>
        <li>Navigate to <strong>125 kHz RFID</strong> from the main menu</li>
        <li>Select <strong>Read</strong></li>
        <li>Hold the card flat against the back of the Flipper Zero</li>
        <li>Wait for the read confirmation (vibration + visual feedback)</li>
        <li>View the card data displayed on screen</li>
        <li>Choose <strong>Save</strong> to store the card data</li>
      </ol>

      <h3 class="section-subtitle">What You'll See</h3>
      <p>When reading an RFID card, the Flipper displays:</p>
      <ul>
        <li><strong>Card Type</strong> - EM4100, HID Prox, Indala, etc.</li>
        <li><strong>UID/ID Number</strong> - The unique identifier</li>
        <li><strong>Format</strong> - How the data is encoded</li>
        <li><strong>Raw Data</strong> - Hexadecimal representation</li>
      </ul>

      <div class="alert alert-info">
        <div class="alert-title">üí° Pro Tip</div>
        <p>Position matters! Hold the card flat against the back center of the Flipper for best results. Some cards may need to be positioned at specific angles.</p>
      </div>
    </section>

    <!-- Understanding NFC -->
    <section class="content-section">
      <h2 class="section-title">üì≤ Understanding NFC Technology</h2>

      <h3 class="section-subtitle">What is NFC?</h3>
      <p>NFC (Near Field Communication) operates at 13.56 MHz and supports more complex protocols than basic RFID. It's based on ISO/IEC 14443 standards and can handle bidirectional communication.</p>

      <h3 class="section-subtitle">Common NFC Applications</h3>
      <ul>
        <li><strong>Contactless Payments</strong> - Credit/debit cards, mobile payment (Apple Pay, Google Pay)</li>
        <li><strong>Public Transportation</strong> - Metro cards, bus passes</li>
        <li><strong>Modern Access Control</strong> - Advanced building security systems</li>
        <li><strong>Smart Posters</strong> - NFC tags for information sharing</li>
        <li><strong>Device Pairing</strong> - Bluetooth pairing, WiFi credentials</li>
      </ul>

      <h3 class="section-subtitle">NFC Card Types</h3>
      <ul>
        <li><strong>MIFARE Classic</strong> - Common but cryptographically weak (1K, 4K variants)</li>
        <li><strong>MIFARE Ultralight</strong> - Simple, low-cost tags with minimal security</li>
        <li><strong>MIFARE DESFire</strong> - Advanced security with encryption (harder to attack)</li>
        <li><strong>NTAG Series</strong> - Popular for consumer NFC tags</li>
        <li><strong>EMV Payment Cards</strong> - Bank cards (cannot be cloned due to security)</li>
      </ul>

      <div class="alert alert-warning">
        <div class="alert-title">‚ö†Ô∏è Important</div>
        <p>Modern payment cards (EMV) use advanced cryptography and cannot be cloned. Attempting to read payment card data for fraudulent purposes is a serious crime.</p>
      </div>
    </section>

    <!-- Reading NFC -->
    <section class="content-section">
      <h2 class="section-title">üì± Reading NFC Cards</h2>

      <h3 class="section-subtitle">Step-by-Step: Reading NFC</h3>
      <ol>
        <li>Navigate to <strong>NFC</strong> from the main menu</li>
        <li>Select <strong>Read Card</strong></li>
        <li>Hold the card against the back of the Flipper</li>
        <li>The Flipper will detect and identify the card type</li>
        <li>View detailed card information</li>
        <li>Save the card data if desired</li>
      </ol>

      <h3 class="section-subtitle">Understanding Card Data</h3>
      <p>NFC cards contain more complex data structures:</p>
      <ul>
        <li><strong>UID</strong> - Unique identifier (4, 7, or 10 bytes)</li>
        <li><strong>Card Type</strong> - MIFARE Classic, Ultralight, DESFire, etc.</li>
        <li><strong>Memory Structure</strong> - Sectors, blocks, pages depending on type</li>
        <li><strong>Access Keys</strong> - Required for reading/writing protected areas</li>
        <li><strong>Application Data</strong> - Stored information (balance, access rights, etc.)</li>
      </ul>

      <h3 class="section-subtitle">MIFARE Classic Attack</h3>
      <p>For MIFARE Classic cards with default or weak keys, the Flipper can attempt dictionary attacks:</p>
      <ol>
        <li>Read card to detect type (MIFARE Classic)</li>
        <li>Select <strong>Detect Reader</strong> to gather authentication attempts</li>
        <li>Use built-in dictionary to find keys</li>
        <li>Once keys found, read full card contents</li>
      </ol>
    </section>

    <!-- Emulation -->
    <section class="content-section">
      <h2 class="section-title">üé≠ Emulating Cards</h2>

      <h3 class="section-subtitle">RFID Emulation</h3>
      <p>After saving an RFID card, you can emulate it:</p>
      <ol>
        <li>Go to <strong>125 kHz RFID</strong> ‚Üí <strong>Saved</strong></li>
        <li>Select your saved card</li>
        <li>Choose <strong>Emulate</strong></li>
        <li>Hold Flipper to reader as you would a card</li>
        <li>The reader should accept it as the original card</li>
      </ol>

      <h3 class="section-subtitle">NFC Emulation</h3>
      <p>NFC emulation works similarly but with more complexity:</p>
      <ol>
        <li>Navigate to <strong>NFC</strong> ‚Üí <strong>Saved</strong></li>
        <li>Select saved card file</li>
        <li>Choose <strong>Emulate</strong></li>
        <li>Present Flipper to NFC reader</li>
      </ol>

      <div class="alert alert-info">
        <div class="alert-title">üí° Emulation Limitations</div>
        <p>Some advanced cards cannot be emulated due to:</p>
        <ul>
          <li>Encrypted sectors requiring authentication</li>
          <li>Challenge-response protocols</li>
          <li>Dynamic cryptograms (like EMV payment cards)</li>
          <li>UID-specific encryption</li>
        </ul>
      </div>
    </section>

    <!-- Practical Exercise -->
    <section class="content-section">
      <h2 class="section-title">üéØ Practical Exercise</h2>

      <h3 class="section-subtitle">Safe Practice Activity</h3>
      <p>Practice reading and emulating with cards you own:</p>

      <ol>
        <li><strong>Prepare Materials</strong>
          <ul>
            <li>Old hotel key card (expired)</li>
            <li>Spare building access card (if you have permission)</li>
            <li>Blank NFC tags for practice</li>
          </ul>
        </li>
        
        <li><strong>RFID Practice</strong>
          <ul>
            <li>Read your 125 kHz card</li>
            <li>Save it with a descriptive name</li>
            <li>Emulate and test on the original reader</li>
            <li>Document the card type and ID format</li>
          </ul>
        </li>
        
        <li><strong>NFC Practice</strong>
          <ul>
            <li>Read an NFC tag or card</li>
            <li>Examine the card structure</li>
            <li>If MIFARE Classic, attempt key recovery</li>
            <li>Save and test emulation</li>
          </ul>
        </li>
        
        <li><strong>Analysis</strong>
          <ul>
            <li>Compare security between different card types</li>
            <li>Note which cards have encryption</li>
            <li>Understand why some cannot be cloned</li>
          </ul>
        </li>
      </ol>

      <div class="alert alert-warning">
        <div class="alert-title">‚ö†Ô∏è Remember</div>
        <p>Only test cards you own or have explicit written permission to test. Unauthorized access card cloning is illegal and unethical.</p>
      </div>
    </section>

    <!-- Security Considerations -->
    <section class="content-section">
      <h2 class="section-title">üõ°Ô∏è Security Considerations</h2>

      <h3 class="section-subtitle">Vulnerabilities in Access Systems</h3>
      <ul>
        <li><strong>Simple UID-Based Systems</strong> - No encryption, easy to clone</li>
        <li><strong>Default Keys</strong> - Many MIFARE Classic deployments use factory defaults</li>
        <li><strong>Physical Security</strong> - If attacker can read your card, they can clone it</li>
        <li><strong>Weak Cryptography</strong> - MIFARE Classic crypto has been broken</li>
      </ul>

      <h3 class="section-subtitle">Better Security Practices</h3>
      <ul>
        <li>Use modern DESFire or encrypted cards</li>
        <li>Implement additional authentication factors</li>
        <li>Monitor for duplicate card usage</li>
        <li>Use card + PIN systems</li>
        <li>Regularly audit access logs</li>
      </ul>

      <h3 class="section-subtitle">Protecting Your Cards</h3>
      <ul>
        <li>Use RFID-blocking wallets or sleeves</li>
        <li>Keep sensitive cards physically secure</li>
        <li>Report lost cards immediately</li>
        <li>Be aware of social engineering attempts</li>
      </ul>
    </section>

    <!-- Lesson Footer -->
    <footer class="lesson-footer">
      <div class="completion-section">
        <div class="xp-reward">+50 XP</div>
        <p>Complete this lesson to earn your XP and unlock the next module!</p>
        <button class="complete-btn" id="completeBtn" onclick="markComplete()">
          Mark Lesson Complete
        </button>
        <div class="nav-buttons">
          <a href="../lesson-2/" class="nav-btn">‚Üê Previous Lesson</a>
          <a href="../../" class="nav-btn">Course Overview</a>
          <a href="../lesson-4/" class="nav-btn">Next Lesson ‚Üí</a>
        </div>
      </div>
    </footer>
  </div>

  <script>
    // Storage configuration - syncs with course overview
    const COURSE_STORAGE_KEY = 'flipper-zero-course';
    const LESSON_ID = 3;

    // Progress tracking functions
    async function loadProgress() {
      try {
        const result = await window.storage.get(COURSE_STORAGE_KEY);
        return result ? JSON.parse(result.value) : { completed: [] };
      } catch (error) {
        return { completed: [] };
      }
    }

    async function saveProgress(progress) {
      try {
        await window.storage.set(COURSE_STORAGE_KEY, JSON.stringify(progress));
        return true;
      } catch (error) {
        console.error('Failed to save progress:', error);
        return false;
      }
    }

    async function markComplete() {
      const btn = document.getElementById('completeBtn');
      btn.disabled = true;
      btn.textContent = 'Saving...';

      const progress = await loadProgress();
      
      if (!progress.completed.includes(LESSON_ID)) {
        progress.completed.push(LESSON_ID);
        const saved = await saveProgress(progress);
        
        if (saved) {
          btn.textContent = '‚úì Lesson Complete!';
          btn.style.background = 'var(--accent)';
          setTimeout(() => {
            window.location.href = '../lesson-4/';
          }, 1500);
        } else {
          btn.textContent = 'Error - Try Again';
          btn.disabled = false;
        }
      } else {
        btn.textContent = '‚úì Already Complete';
      }
    }

    // Check if already completed
    async function checkCompletion() {
      const progress = await loadProgress();
      if (progress.completed.includes(LESSON_ID)) {
        const btn = document.getElementById('completeBtn');
        btn.textContent = '‚úì Completed';
        btn.style.background = 'var(--border)';
      }
    }

    // Accessibility functions
    function changeFontSize(size) {
      document.body.className = document.body.className.replace(/font-\w+/g, '');
      if (size !== 'normal') {
        document.body.classList.add('font-' + size);
      }
      localStorage.setItem('fontSize', size);
    }

    function toggleContrast() {
      document.body.classList.toggle('high-contrast');
      localStorage.setItem('highContrast', document.body.classList.contains('high-contrast'));
    }

    function loadA11yPreferences() {
      const fontSize = localStorage.getItem('fontSize');
      if (fontSize && fontSize !== 'normal') {
        document.body.classList.add('font-' + fontSize);
      }

      const highContrast = localStorage.getItem('highContrast') === 'true';
      if (highContrast) {
        document.body.classList.add('high-contrast');
      }
    }

    // Initialize
    loadA11yPreferences();
    checkCompletion();
  </script>
</body>
</html>
