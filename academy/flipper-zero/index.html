<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Flipper Zero Course | tw¡st3d_¡nk Academy</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --bg-dark: #0a0a0a;
      --bg-card: #1a1a1a;
      --accent: #00ff88;
      --text-primary: #ffffff;
      --text-secondary: #b0b0b0;
      --border: #333;
    }

    body {
      font-family: 'Atkinson Hyperlegible', sans-serif;
      background: var(--bg-dark);
      color: var(--text-primary);
      line-height: 1.6;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    /* Accessibility Controls */
    .a11y-controls {
      position: fixed;
      top: 20px;
      right: 20px;
      background: var(--bg-card);
      border: 2px solid var(--border);
      border-radius: 12px;
      padding: 15px;
      z-index: 1000;
      display: flex;
      gap: 10px;
    }

    .a11y-btn {
      background: var(--bg-dark);
      border: 1px solid var(--border);
      color: var(--text-primary);
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s ease;
    }

    .a11y-btn:hover {
      border-color: var(--accent);
      color: var(--accent);
    }

    .a11y-btn:focus {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }

    /* Header */
    .header {
      margin-bottom: 40px;
    }

    .back-link {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      color: var(--text-secondary);
      text-decoration: none;
      margin-bottom: 20px;
      transition: color 0.3s ease;
    }

    .back-link:hover {
      color: var(--accent);
    }

    .course-title {
      font-size: 3rem;
      font-weight: 700;
      margin-bottom: 10px;
      background: linear-gradient(135deg, var(--accent), #00ccff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .course-subtitle {
      font-size: 1.25rem;
      color: var(--text-secondary);
      margin-bottom: 30px;
    }

    /* Progress Dashboard */
    .progress-dashboard {
      background: var(--bg-card);
      border: 2px solid var(--border);
      border-radius: 16px;
      padding: 30px;
      margin-bottom: 40px;
    }

    .progress-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 20px;
    }

    .progress-title {
      font-size: 1.5rem;
      font-weight: 700;
    }

    .progress-percentage {
      font-size: 2rem;
      font-weight: 700;
      color: var(--accent);
    }

    .progress-bar-container {
      width: 100%;
      height: 12px;
      background: var(--bg-dark);
      border-radius: 6px;
      overflow: hidden;
      margin-bottom: 20px;
    }

    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, var(--accent), #00ccff);
      border-radius: 6px;
      transition: width 0.5s ease;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 20px;
    }

    .stat-card {
      background: var(--bg-dark);
      padding: 15px;
      border-radius: 8px;
      text-align: center;
    }

    .stat-value {
      font-size: 2rem;
      font-weight: 700;
      color: var(--accent);
      display: block;
    }

    .stat-label {
      color: var(--text-secondary);
      font-size: 0.9rem;
    }

    /* Course Prerequisites */
    .prerequisites {
      background: var(--bg-card);
      border: 2px solid var(--border);
      border-radius: 16px;
      padding: 30px;
      margin-bottom: 40px;
    }

    .prerequisites h2 {
      font-size: 1.5rem;
      margin-bottom: 15px;
      color: var(--accent);
    }

    .prereq-list {
      list-style: none;
      display: grid;
      gap: 10px;
    }

    .prereq-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px;
      background: var(--bg-dark);
      border-radius: 8px;
    }

    .prereq-icon {
      color: var(--accent);
      font-size: 1.2rem;
    }

    /* Lessons Grid */
    .lessons-grid {
      display: grid;
      gap: 25px;
      margin-bottom: 40px;
    }

    .lesson-card {
      background: var(--bg-card);
      border: 2px solid var(--border);
      border-radius: 16px;
      padding: 25px;
      transition: all 0.3s ease;
      position: relative;
      cursor: pointer;
    }

    .lesson-card:hover {
      border-color: var(--accent);
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(0, 255, 136, 0.2);
    }

    .lesson-card.completed {
      border-color: var(--accent);
    }

    .lesson-header {
      display: flex;
      justify-content: space-between;
      align-items: start;
      margin-bottom: 15px;
    }

    .lesson-number {
      font-size: 0.9rem;
      color: var(--text-secondary);
      font-weight: 700;
    }

    .completion-check {
      width: 24px;
      height: 24px;
      border: 2px solid var(--border);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .lesson-card.completed .completion-check {
      background: var(--accent);
      border-color: var(--accent);
    }

    .checkmark {
      display: none;
      color: var(--bg-dark);
      font-weight: 700;
    }

    .lesson-card.completed .checkmark {
      display: block;
    }

    .lesson-title {
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 10px;
    }

    .lesson-description {
      color: var(--text-secondary);
      margin-bottom: 15px;
      line-height: 1.6;
    }

    .lesson-meta {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      margin-bottom: 15px;
    }

    .meta-badge {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      background: var(--bg-dark);
      border-radius: 6px;
      font-size: 0.85rem;
      color: var(--text-secondary);
    }

    .xp-badge {
      background: linear-gradient(135deg, var(--accent), #00ccff);
      color: var(--bg-dark);
      font-weight: 700;
    }

    .difficulty {
      display: flex;
      gap: 3px;
    }

    .difficulty-dot {
      width: 6px;
      height: 6px;
      background: var(--border);
      border-radius: 50%;
    }

    .difficulty-dot.filled {
      background: var(--accent);
    }

    .lesson-prereqs {
      font-size: 0.85rem;
      color: var(--text-secondary);
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px solid var(--border);
    }

    .cta-button {
      background: var(--accent);
      color: var(--bg-dark);
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-weight: 700;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 100%;
      margin-top: 15px;
    }

    .cta-button:hover {
      transform: scale(1.02);
      box-shadow: 0 4px 16px rgba(0, 255, 136, 0.4);
    }

    .cta-button:focus {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }

    /* Font Size Classes */
    body.font-small { font-size: 14px; }
    body.font-large { font-size: 18px; }
    body.font-xl { font-size: 22px; }

    /* High Contrast Mode */
    body.high-contrast {
      --bg-dark: #000000;
      --bg-card: #1a1a1a;
      --text-primary: #ffffff;
      --border: #00ff88;
    }

    /* Reduced Motion */
    @media (prefers-reduced-motion: reduce) {
      * {
        animation: none !important;
        transition: none !important;
      }
    }

    /* Responsive */
    @media (max-width: 768px) {
      .course-title {
        font-size: 2rem;
      }

      .a11y-controls {
        position: static;
        margin-bottom: 20px;
        flex-wrap: wrap;
      }

      .progress-header {
        flex-direction: column;
        align-items: start;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Accessibility Controls -->
    <div class="a11y-controls">
      <button class="a11y-btn" onclick="changeFontSize('small')" aria-label="Decrease font size">A-</button>
      <button class="a11y-btn" onclick="changeFontSize('normal')" aria-label="Normal font size">A</button>
      <button class="a11y-btn" onclick="changeFontSize('large')" aria-label="Increase font size">A+</button>
      <button class="a11y-btn" onclick="changeFontSize('xl')" aria-label="Extra large font size">A++</button>
      <button class="a11y-btn" onclick="toggleContrast()" aria-label="Toggle high contrast">◐</button>
    </div>

    <!-- Header -->
    <div class="header">
      <a href="../index.html" class="back-link">← Back to Academy</a>
      <h1 class="course-title">Flipper Zero Mastery</h1>
      <p class="course-subtitle">Master hardware hacking with the Swiss Army knife of wireless tools</p>
    </div>

    <!-- Progress Dashboard -->
    <div class="progress-dashboard">
      <div class="progress-header">
        <h2 class="progress-title">Your Progress</h2>
        <span class="progress-percentage" id="progressPercentage">0%</span>
      </div>
      <div class="progress-bar-container">
        <div class="progress-bar" id="progressBar" style="width: 0%"></div>
      </div>
      <div class="stats-grid">
        <div class="stat-card">
          <span class="stat-value" id="completedLessons">0</span>
          <span class="stat-label">Lessons Completed</span>
        </div>
        <div class="stat-card">
          <span class="stat-value">6</span>
          <span class="stat-label">Total Lessons</span>
        </div>
        <div class="stat-card">
          <span class="stat-value">~4.5h</span>
          <span class="stat-label">Total Duration</span>
        </div>
        <div class="stat-card">
          <span class="stat-value" id="earnedXP">0</span>
          <span class="stat-label">XP Earned</span>
        </div>
      </div>
    </div>

    <!-- Course Prerequisites -->
    <div class="prerequisites">
      <h2>📋 Course Prerequisites</h2>
      <ul class="prereq-list">
        <li class="prereq-item">
          <span class="prereq-icon">✓</span>
          <span>Basic understanding of wireless protocols (WiFi, Bluetooth, RFID)</span>
        </li>
        <li class="prereq-item">
          <span class="prereq-icon">✓</span>
          <span>Flipper Zero device (or access to emulator for theory)</span>
        </li>
        <li class="prereq-item">
          <span class="prereq-icon">✓</span>
          <span>Familiarity with command-line interfaces</span>
        </li>
        <li class="prereq-item">
          <span class="prereq-icon">✓</span>
          <span>Basic knowledge of security concepts (optional but helpful)</span>
        </li>
      </ul>
    </div>

    <!-- Lessons Grid -->
    <div class="lessons-grid" id="lessonsGrid"></div>
  </div>

  <script>
    // Lesson data
    const lessons = [
      {
        id: 1,
        title: "Introduction to Flipper Zero",
        description: "Get started with your Flipper Zero. Learn about its capabilities, interface, and basic operations.",
        duration: "30 min",
        xp: 50,
        difficulty: 1,
        prerequisites: "None",
        file: "lesson-1.html"
      },
      {
        id: 2,
        title: "Sub-GHz Radio Fundamentals",
        description: "Explore sub-gigahertz radio frequencies. Learn to capture, analyze, and replay RF signals.",
        duration: "45 min",
        xp: 50,
        difficulty: 2,
        prerequisites: "Lesson 1",
        file: "lesson-2.html"
      },
      {
        id: 3,
        title: "RFID & NFC Hacking",
        description: "Master RFID and NFC protocols. Read, clone, and emulate access cards and tags.",
        duration: "50 min",
        xp: 50,
        difficulty: 2,
        prerequisites: "Lesson 1",
        file: "lesson-3.html"
      },
      {
        id: 4,
        title: "Infrared Control Mastery",
        description: "Control devices with IR signals. Capture, save, and transmit infrared remote commands.",
        duration: "35 min",
        xp: 50,
        difficulty: 1,
        prerequisites: "Lesson 1",
        file: "lesson-4.html"
      },
      {
        id: 5,
        title: "BadUSB & Automation",
        description: "Create automated scripts using BadUSB. Learn payload development and HID attacks.",
        duration: "55 min",
        xp: 50,
        difficulty: 3,
        prerequisites: "Lessons 1-4",
        file: "lesson-5.html"
      },
      {
        id: 6,
        title: "Advanced Projects & Ethics",
        description: "Build complex projects and understand ethical hacking principles. Responsible disclosure and legal boundaries.",
        duration: "45 min",
        xp: 50,
        difficulty: 3,
        prerequisites: "Lessons 1-5",
        file: "lesson-6.html"
      }
    ];

    // Storage keys
    const STORAGE_KEY = 'flipper-zero-course';

    // Load completion data
    async function loadProgress() {
      try {
        const result = await window.storage.get(STORAGE_KEY);
        return result ? JSON.parse(result.value) : { completed: [] };
      } catch (error) {
        return { completed: [] };
      }
    }

    // Save completion data
    async function saveProgress(progress) {
      try {
        await window.storage.set(STORAGE_KEY, JSON.stringify(progress));
      } catch (error) {
        console.error('Failed to save progress:', error);
      }
    }

    // Calculate and update progress
    async function updateProgress() {
      const progress = await loadProgress();
      const completedCount = progress.completed.length;
      const percentage = Math.round((completedCount / lessons.length) * 100);
      const earnedXP = completedCount * 50;

      document.getElementById('progressPercentage').textContent = percentage + '%';
      document.getElementById('progressBar').style.width = percentage + '%';
      document.getElementById('completedLessons').textContent = completedCount;
      document.getElementById('earnedXP').textContent = earnedXP;

      return progress;
    }

    // Render difficulty dots
    function renderDifficulty(level) {
      let dots = '';
      for (let i = 1; i <= 3; i++) {
        dots += `<span class="difficulty-dot ${i <= level ? 'filled' : ''}"></span>`;
      }
      return dots;
    }

    // Render lessons
    async function renderLessons() {
      const progress = await updateProgress();
      const grid = document.getElementById('lessonsGrid');

      grid.innerHTML = lessons.map(lesson => {
        const isCompleted = progress.completed.includes(lesson.id);
        return `
          <div class="lesson-card ${isCompleted ? 'completed' : ''}" onclick="goToLesson(${lesson.id})">
            <div class="lesson-header">
              <span class="lesson-number">LESSON ${lesson.id}</span>
              <div class="completion-check">
                <span class="checkmark">✓</span>
              </div>
            </div>
            <h3 class="lesson-title">${lesson.title}</h3>
            <p class="lesson-description">${lesson.description}</p>
            <div class="lesson-meta">
              <div class="meta-badge xp-badge">
                ⚡ ${lesson.xp} XP
              </div>
              <div class="meta-badge">
                ⏱️ ${lesson.duration}
              </div>
              <div class="meta-badge">
                <div class="difficulty">
                  ${renderDifficulty(lesson.difficulty)}
                </div>
              </div>
            </div>
            <div class="lesson-prereqs">
              📌 Prerequisites: ${lesson.prerequisites}
            </div>
            <button class="cta-button" onclick="goToLesson(${lesson.id}); event.stopPropagation();">
              ${isCompleted ? 'Review Lesson' : 'Start Lesson'} →
            </button>
          </div>
        `;
      }).join('');
    }

    // Navigate to lesson
    function goToLesson(lessonId) {
      const lesson = lessons.find(l => l.id === lessonId);
      if (lesson) {
        window.location.href = lesson.file;
      }
    }

    // Accessibility functions
    function changeFontSize(size) {
      document.body.className = document.body.className.replace(/font-\w+/g, '');
      if (size !== 'normal') {
        document.body.classList.add('font-' + size);
      }
      localStorage.setItem('fontSize', size);
    }

    function toggleContrast() {
      document.body.classList.toggle('high-contrast');
      localStorage.setItem('highContrast', document.body.classList.contains('high-contrast'));
    }

    // Load accessibility preferences
    function loadA11yPreferences() {
      const fontSize = localStorage.getItem('fontSize');
      if (fontSize && fontSize !== 'normal') {
        document.body.classList.add('font-' + fontSize);
      }

      const highContrast = localStorage.getItem('highContrast') === 'true';
      if (highContrast) {
        document.body.classList.add('high-contrast');
      }
    }

    // Initialize
    loadA11yPreferences();
    renderLessons();
  </script>
</body>
</html>
